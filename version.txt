This is the last version with combined thread_base. After this version, thread_base will be separated, and becomes the dependency of Madd.